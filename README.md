# Embedding's для MovieLens 27M датасета

*Проект был выполнен в рамках прохождения отбора на стажировку в корпорацию VK* | *весна 2023*
- Стек: `Python` `Jupyter` `pandas` `numpy` `matplotlib` `keras` `sklearn`




## Описание задачи

Необходимо построить векторное представление пользователей и фильмов используя нейросетевые подходы, чтобы можно было по эмбендингу пользователя искать похожие эмбендинги фильмов и рекомендовать ему их.

Обратить внимание на:

1. Какие данные на обучение и валидацию, обоснование.
2. Выбор и обоснование метрики
3. Разработка архитектуры нейронной сети с пояснением
4. Обучение и валидация
5. Решение должно быть воспроизводимым с подробными комментариями на каждом шаге




## Описание данных

*Полный* датасет MovieLens с сайта grouplens.org: https://files.grouplens.org/datasets/movielens/ml-latest.zip

В датасете содержится информация о фильмах и оценках пользователей.


**Структура файла данных рейтингов (ratings.csv)**

-----------------------------------------

Все рейтинги содержатся в файле `ratings.csv`. Каждая строка этого файла после строки заголовка представляет собой одну оценку одного фильма одним пользователем и имеет следующий формат:
userId,movieId,rating,timestamp

Строки в этом файле упорядочены сначала по идентификатору пользователя, затем, внутри пользователя, по идентификатору фильма.

Оценки выставляются по 5-звездочной шкале, с шагом в ползвезды (0,5 звезды - 5,0 звезды).

Временные метки представляют собой секунды с полуночи по всемирному координированному времени (UTC) от 1 января 1970 года.



## Вывод 

В ходе выполнения данного проекта были реализованы следующие задачи:
- **Подготовка данных**
- - Загрузка данных
- - Проверка на пропуски и дубликаты
- - Разделение данных на train, valid, test учитывая временную зависимость

|

- **Создание модели**
- - Создание модели Low Rank Matrix Factorization c NN
- - Обучение модели с помощью Adam optimizer и MSE loss. Прогресс был сохранен в переменную history

|

- **Анализ модели**
- - Построение графика обучения модели
- - Проверка модели на тестовых данных
- - Создание константной модели
- - Сравнение моделей
- - Сохранение модели в файл

|

- **Создание рекомендаций на основе эмбеддингов**
- - Получения эмбеддингов из обученной модели, по способу получения весов слоя
- - Сохранение эмбеддингов в файлы
- - Создание функции для рекомендаций фильмов для пользователя. Для этого используется скалярное произведение эмбеддинга пользователя и эмбеддингов фильмов

|

- **Создание эмбеддингов для новых пользователей**
- - Создание нового пользователя
- - Получение эмбеддинга нового пользователя с помощью обученной модели



**Что можно улучшить:**
- Модель обучалась долго. Можно было использовать GPU для ускорения обучения.
- Можно увеличить количество эпох обучения, чтобы улучшить качество модели. На данный момент этого не было сделано из-за недостатка времени.
- После проверки адекватности модели, можно докинуть валидационные данные в обучающие, чтобы улучшить качество модели.



## Инструкция по использованию проекта
Данный проект размещен на Github и выполнен в виде Jupyter Notebook. Для его использования потребуется установленный на компьютере Python и Jupyter Notebook. Так же, для корректной работы, необходимо установить следующие библиотеки:
- `pandas` `numpy` `matplotlib` `pylab` `scikit-learn` `tensorflow` `keras`

## Клонирование репозитория

1. На странице репозитория нажмите кнопку "Code" и выберите способ клонирования.
2. Скопируйте ссылку.
3. Откройте терминал на вашем компьютере.
4. Выберите директорию, куда вы хотите скопировать проект, используя команду `cd <название дериктории>`.
5. Клонируйте репозиторий на свой компьютер, используя команду git clone и вставив скопированную ссылку:
```
git clone https://github.com/KirillFazi/vk_test_task_2023.git
```

## Запуск проекта

1. Откройте терминал на вашем компьютере.
2. Выберите директорию, куда вы скопировали проект, используя команду `cd <название дериктории>`.
3. Запустите Jupyter Notebook, используя команду `jupyter notebook`.
4. В открывшемся окне браузера выберите файл `<название_проекта>.ipynb`.
